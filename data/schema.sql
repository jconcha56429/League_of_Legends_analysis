CREATE TABLE "self_data" (
"allInPings" INTEGER, 
"assistMePings" INTEGER, 
"assists" INTEGER,  
"baitPings" INTEGER,  
"baronKills" INTEGER,  	
"basicPings" INTEGER,  
"bountyLevel" INTEGER, 
"champExperience" INTEGER,  
"champLevel" INTEGER,  
"championId" INTEGER,  
"championName" VARCHAR, 
"championTransform" INTEGER, 
"commandPings" INTEGER, 
"consumablesPurchased" INTEGER, 
"damageDealtToBuildings" INTEGER,  
"damageDealtToObjectives" INTEGER,  
"damageDealtToTurrets" INTEGER,  
"damageSelfMitigated" INTEGER,  
"dangerPings" INTEGER,  
"deaths" INTEGER,  
"detectorWardsPlaced" INTEGER,  
"doubleKills" INTEGER, 
"dragonKills" INTEGER,  
"eligibleForProgression" BOOLEAN,  
"enemyMissingPings" INTEGER,  
"enemyVisionPings" INTEGER,  
"firstBloodAssist" BOOLEAN,  
"firstBloodKill" BOOLEAN,  
"firstTowerAssist" BOOLEAN,  
"firstTowerKill" BOOLEAN,  
"gameEndedInEarlySurrender" BOOLEAN,  
"gameEndedInSurrender" BOOLEAN,  
"getBackPings" INTEGER,  
"goldEarned" INTEGER,  
"goldSpent" INTEGER,  
"holdPings" INTEGER,  
"individualPosition" VARCHAR,  
"inhibitorKills" INTEGER,  
"inhibitorTakedowns" INTEGER,  
"inhibitorsLost" INTEGER,  
"item0" INTEGER,  
"item1" INTEGER,  
"item2" INTEGER, 
 "item3" INTEGER,  
"item4" INTEGER,  
"item5" INTEGER,  
"item6" INTEGER,  
"itemsPurchased" INTEGER,  
"killingSprees" INTEGER,  
"kills" INTEGER, 
"lane" VARCHAR,  
"largestCriticalStrike" INTEGER,  
"largestKillingSpree" INTEGER, 
"largestMultiKill" INTEGER,  
"longestTimeSpentLiving" INTEGER,  
"magicDamageDealt" INTEGER,  
"magicDamageDealtToChampions" INTEGER,  
"magicDamageTaken" INTEGER, 
"needVisionPings" INTEGER, 
"neutralMinionsKilled" INTEGER,  
"nexusKills" INTEGER,  
"nexusLost" INTEGER, 
 "nexusTakedowns" INTEGER,  
"objectivesStolen" INTEGER,  
"objectivesStolenAssists" INTEGER, 
 "onMyWayPings" INTEGER,  
"participantId" INTEGER,  "pentaKills" INTEGER,  
"physicalDamageDealt" INTEGER,  
"physicalDamageDealtToChampions" INTEGER,  
"physicalDamageTaken" INTEGER,  
"profileIcon" INTEGER,  
"pushPings" INTEGER,  
"quadraKills" INTEGER, 
"role" VARCHAR,  
"sightWardsBoughtInGame" INTEGER, 
"spell1Casts" INTEGER,  "spell2Casts" INTEGER, 
"spell3Casts" INTEGER,  
"spell4Casts" INTEGER,  
"summoner1Casts" INTEGER,  
"summoner1Id" INTEGER,  
"summoner2Casts" INTEGER,  
"summoner2Id" INTEGER,  
"summonerLevel" INTEGER,  
"teamEarlySurrendered" BOOLEAN,  
"teamId" INTEGER,  
"teamPosition" VARCHAR, 
"timeCCingOthers" INTEGER,  
"timePlayed" INTEGER,  
"totalDamageDealt" INTEGER, 
"totalDamageDealtToChampions" INTEGER,  
"totalDamageShieldedOnTeammates" INTEGER,  
"totalDamageTaken" INTEGER,  
"totalHeal" INTEGER,  
"totalHealsOnTeammates" INTEGER, 
"totalMinionsKilled" INTEGER,  
"totalTimeCCDealt" INTEGER,  
"totalTimeSpentDead" INTEGER,  
"totalUnitsHealed" INTEGER,  
"tripleKills" INTEGER,  
"trueDamageDealt" INTEGER,  
"trueDamageDealtToChampions" INTEGER,  
"trueDamageTaken" INTEGER,  
"turretKills" INTEGER,  
"turretTakedowns" INTEGER,  
"turretsLost" INTEGER,  
"unrealKills" INTEGER,  
"visionClearedPings" INTEGER,  
"visionScore" INTEGER,  
"visionWardsBoughtInGame" INTEGER,  
"wardsKilled" INTEGER,  
"wardsPlaced" INTEGER, 
"win" BOOLEAN)


-- WITH wins as (select "championName" AS champion,
-- win,
-- count("win") as win_tf
-- from self_data
-- group by win, "championName"),

-- champ_count AS (
-- select "championName" as champion,
-- count("championName") as total_games
-- from self_data
-- group by "championName")

-- select wins.champion,
-- wins.win,
-- wins.win_tf,
-- champ_count.total_games,
-- CAST(wins.win_tf AS FLOAT)/(CAST(champ_count.total_games AS FLOAT)) AS win_percent
-- FROM wins
-- LEFT JOIN champ_count 
-- ON wins.champion = champ_count.champion
-- ORDER BY champion